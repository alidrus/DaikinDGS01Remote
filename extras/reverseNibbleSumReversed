#!/usr/bin/env php
<?php
$payloads = [
    '0110100001001000101010000110100010011010000001010110100000100101',
    '0110100001000001101010000110100010011010000001010110100000101000',
    '0110100001000010101010000110100010011010000001010110100000101011',
    '0110100001000100101010000110100010011010000001010110100000101101',
    '0110100001001000001001000110100010000000001001010110100010101101',
    '0110100000100001000001000110100010011010000001010110100000101111',
    '0110100000100010100001000110100010011010000001010110100000100011',
    '0110100000100100100001000110100010011010000001010110100000100101',
    '0110100000100100011001000110100010011010000001010110100000101111',
    '0110100000100100011001000110100010011010000001010110100010100000',
    '0110100001001000101000100000010010011010000001010110100010101001',
    '0110100001001000101001001000010010011010000001010110100010110000',
    '0110100001001000100101001000010010011010000001010110100010110010',
    '0110100001001000000011001000010010011010000001010110100010110011',
    '0110100000100001011011001000010010011010000001010110100010101100',
    '0110100000100001011011001000010010011010000001010110100010101100',
    '0110100000100001011011001000010010011010000001010110100010111101',
    '0110100001001000101000100000010010011010000001010110100010101001',
    '0110100001001000101000100000010010011010000001011110100010100101',
    '0110100001001000101000100000010010011010000001010001100010101101',
    '0110100001001000011000100000010010011010000001011001100010101011',
    '0110100001001000011000100000010010011010000001010000010010101010',
    '0110100001001000011000100000010010011010000001011000010010100110',
    '0110100001001000111000100000010010011010000001010100010010100001',
    '0110100001001000111000000000010010011010000001011000010010101001',
    '0110100001001000000100100000010010010010000001010010010010101101',
    '0110100001001000011000101000000010011010000001010110100010101001',
    '0110100001001100011000101000000010011010000001010110100010101101',
    '0110100001001001100010101000000010011010000001010110100010101011',
    '0110100001001000010010101000000010011010000001010110100010100110',
    '0110100001001000000010000100000010011010000001010110100011101100',
    '0110100001001000001010000100000010011010000001010110100010101010',
    '0110100001001000011010000100000010011010000001010110100011101110',
    '0110100001001000101000100110000000001000000010000110100000100110',
    '0110100001001000110010100110000000001000000010000110100000101010',
    '0110100001001000001000000001000000001000000010000110100000101100',
    '0110100001001000111011000000100000001000000010000110100000100100',
    '0110100001001000101000100100100000001000000010000110100000101100',
    '0110100001001000110000001100100000001000000010000110100000100111',
    '0110100001001000111000001010100000001001010000100110100000101000',
    '0110100001001000000100001010100000001000010000100110100000100101',
    '0110100001001000110010001010100011000111010000100110100000100110',
    '0110100001001000110010001010100011000110010000100110100000100111',
    '0110100001001000000110001010100011000110100000010110100000100110',
    '0110100001001000100110001010100011000110100000000110100000101111',
    '0110100001001000101010001010100011000110001010110110100000101101',
    '0110100001001000111010001010100011000110001010100110100000101010',
    '0110100001001000100100000100010011000110100000000110100000100011',
    '0110100010001000100100000100010011000110100000000110100000101101',
    '0110100000100001100100000100010011000110100000000110100000101010',
];

foreach($payloads as $payload)
{
    $data = preg_replace('/[0-9]{4}$/', '', $payload);
    $checksum = substr($payload, -4);

    printf(
        "Payload:     %s\n".
        "Data:        %s\n".
        "Checksum:    %s\n",
        $payload,
        $data,
        $checksum
    );

    print "Nibble | ReverseNibble | Nibble Sum | Reverse Nibble Sum | Reverse of Reverse Nibble Sum \n";

    $sumNibbles = 0;
    $sumReversedNibbles = 0;
    $sumXOR1 = 0;
    for ($i = 0; $i < strlen($data); $i += 4)
    {
        $nibble = substr($data, $i, 4);
        $nibbleReversed = strrev($nibble);

        $sumNibbles += intval(bindec($nibble));
        $sumReversedNibbles += intval(bindec($nibbleReversed));

        printf(
            "%6s | %13s |       %04b |               %04b | %29s\n",
            $nibble,
            $nibbleReversed,
            $sumNibbles & 0xF,
            $sumReversedNibbles & 0xF,
            strrev(sprintf('%04b', $sumReversedNibbles & 0xF))
        );
    }

    print "-------------------------------------------------\n";
}
